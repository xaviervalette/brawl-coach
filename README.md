# brawl-tier
Extract brawl star top tier from players data.

## Working environment
### Network diagram
![image](https://user-images.githubusercontent.com/28600326/132100796-b649801a-9732-40bd-ba50-91907e18ecb3.png)

### AWS VM
To connect to the AWS EC2 instance, you need:
- An SSH client
- The EC2 "brawl-star-api.pem" RSA key

Use the following command to access to the AWS EC2 instance:
```
ssh -i "brawl-star-api.pem" ec2-user@ec2-15-188-47-187.eu-west-3.compute.amazonaws.com
```

You should enter into the following shell:
![image](https://user-images.githubusercontent.com/28600326/131877713-990a8a5f-8dba-4e98-b9cf-c033a0c3b2c6.png)
> Note: This instance is free of charge while respecting some performance restriction.

### Python
#### Version
```
[ec2-user@ip-172-31-45-183 ~]$ python -V
Python 2.7.18
```

#### Libraries

### API
The API used in this project is the offical Supercell Brawl Star API that you can find here https://developer.brawlstars.com/#/,

To use it, first create an account, and then bind it to an API token that you create here: https://developer.brawlstars.com/#/new-key

![image](https://user-images.githubusercontent.com/28600326/131879099-3dfdae3e-08e0-4cd1-b412-36101d9749fc.png)
> Note: Replace X.X.X.X with your public IP address that you can find here: http://www.mon-ip.com/

Below is the output of the successfully created key:
![image](https://user-images.githubusercontent.com/28600326/131879625-aa300953-3e75-45b8-b228-cd8f0bf93a95.png)


Then, use it in the following code to GET content (code snipet generated by Postman and stored in api.py):
```python
import requests

url = "https://api.brawlstars.com/v1/rankings/FR/players"

payload={}
headers = {
  'Authorization': 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiIsImtpZCI6IjI4YTMxOGY3LTAwMDAtYTFlYi03ZmExLTJjNzQzM2M2Y2NhNSJ9.eyJpc3MiOiJzdXBlcmNlbGwiLCJhdWQiOiJzdXBlcmNlbGw6Z2FtZWFwaSIsImp0aSI6ImU5MjY2ZTY3LTllYzQtNGE1OS1hNjAzLTA0ZTc4YWY5ZGRjYSIsImlhdCI6MTYzMDU5OTE4Mywic3ViIjoiZGV2ZWxvcGVyLzk2NWU0ZGI3LTU3YTMtM2FhYy1hYmNhLWE2NzEzODI5NWJiMiIsInNjb3BlcyI6WyJicmF3bHN0YXJzIl0sImxpbWl0cyI6W3sidGllciI6ImRldmVsb3Blci9zaWx2ZXIiLCJ0eXBlIjoidGhyb3R0bGluZyJ9LHsiY2lkcnMiOlsiMTA5LjI0LjIxOS4xMjUiXSwidHlwZSI6ImNsaWVudCJ9XX0.vgNoq2Jr9X1kLJvvvRxiEG_zZjSFuNihkmhOQiHtSvUW6UZUwrsjYSVvTazclJDRIXnC98TNkXhKtJQso1HMeg'
}

response = requests.request("GET", url, headers=headers, data=payload)

print(response.text)

```
Command
```
[ec2-user@ip-172-31-45-183 brawl-tier]$ python api.py
```

## Data structure
### Battlelog
```json
{
      "battleTime": "20210902T175027.000Z",
      "event": {
        "id": int,
        "mode": string,
        "map": string
      },
      "battle": {
        "mode": string,
        "type": string,
        "result": string,
        "duration": int,
        "trophyChange": int,
        "starPlayer": {
          "tag": string,
          "name": string,
          "brawler": {
            "id": int,
            "name": string,
            "power": int,
            "trophies": int
          }
        },
        "teams": [
          [
            {
              "tag": string,
              "name": string,
              "brawler": {
                "id": int,
                "name": string,
                "power": int,
                "trophies": int
              }
            },
            {
              "tag": string,
              "name": string,
              "brawler": {
                "id": int,
                "name": string,
                "power": int,
                "trophies": int
              }
            },
            {
              "tag": string,
              "name": string,
              "brawler": {
                "id": int,
                "name": string,
                "power": int,
                "trophies": int
              }
            }
          ],
          [
            {
              "tag": string,
              "name": string,
              "brawler": {
                "id": int,
                "name": string,
                "power": int,
                "trophies": int
              }
            },
            {
              "tag": string,
              "name": string,
              "brawler": {
                "id": int,
                "name": string,
                "power": int,
                "trophies": int
              }
            },
            {
              "tag": string,
              "name": string,
              "brawler": {
                "id": int,
                "name": string,
                "power": int,
                "trophies": int
              }
            }
          ]
        ]
      }
    }
```
### Ranking
```json
{
  "tag":string,
  "name":string,
  "nameColor":string,
  "icon":
  {
    "id":int
  },
  "trophies":int,
  "rank":int,
  "club":{
    "name":string
  }
}
```

### YAML
![image](https://user-images.githubusercontent.com/28600326/132695100-1d18d106-70ba-4fc0-9c33-7683c9a13b11.png)
